<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>Каталог автомобілів</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #121212 0%, #1f1f1f 100%);
            color: #f1f1f1;
            font-family: 'Segoe UI', sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .navbar {
            background: linear-gradient(to right, #1a1a1a, #2c2c2c);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            padding: 15px 0;
            min-height: 70px;
        }

        .navbar-brand {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ffffff !important;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: color 0.3s ease, transform 0.3s ease;
            position: relative;
            margin-left: 15px;
        }

            .navbar-brand:hover {
                color: #00d4ff !important;
                transform: scale(1.05);
                text-shadow: 0 0 15px rgba(0, 212, 255, 0.7);
            }

            .navbar-brand::after {
                content: '';
                position: absolute;
                width: 0;
                height: 2px;
                background: #00d4ff;
                bottom: -5px;
                left: 0;
                transition: width 0.3s ease;
            }

            .navbar-brand:hover::after {
                width: 100%;
            }

        .sort-select {
            background: linear-gradient(145deg, #2c2c2c, #1a1a1a);
            color: #ffffff;
            border: 1px solid #00d4ff;
            border-radius: 25px;
            padding: 8px 10px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
            outline: none;
            width: 150px;
            margin-right: 10px;
        }

            .sort-select:hover, .sort-select:focus {
                background: linear-gradient(145deg, #3a3a3a, #262626);
                box-shadow: 0 0 15px rgba(0, 212, 255, 0.7);
                border-color: #ff4d4d;
            }

            .sort-select option {
                background: #1a1a1a;
                color: #ffffff;
            }

        .admin-panel {
            background: linear-gradient(145deg, #1e1e1e, #2c2c2c);
            padding: 20px;
            margin: 20px auto;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            display: none;
            max-width: 600px;
            text-align: center;
        }

            .admin-panel h3 {
                color: #00d4ff;
                margin-bottom: 15px;
            }

            .admin-panel button {
                background: linear-gradient(145deg, #00d4ff, #007bff);
                border: none;
                color: #fff;
                padding: 8px 15px;
                border-radius: 20px;
                margin: 0 10px;
                transition: all 0.3s ease;
            }

                .admin-panel button:hover {
                    background: linear-gradient(145deg, #007bff, #00d4ff);
                    transform: translateY(-2px);
                    box-shadow: 0 0 10px rgba(0, 212, 255, 0.7);
                }

        .vehicle-card {
            background: linear-gradient(145deg, #1e1e1e, #2c2c2c);
            border-radius: 0.5rem;
            padding: 15px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            height: 100%;
            position: relative;
            overflow: hidden;
        }

            .vehicle-card:hover {
                transform: translateY(-10px);
                box-shadow: 0 12px 25px rgba(0, 212, 255, 0.3);
            }

            .vehicle-card img {
                max-width: 100%;
                height: 150px;
                object-fit: cover;
                border-radius: 0.25rem;
                transition: transform 0.3s ease;
            }

            .vehicle-card:hover img {
                transform: scale(1.1);
            }

            .vehicle-card h5 {
                margin-top: 10px;
                color: #ffffff;
                font-size: 1.2rem;
                text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
            }

            .vehicle-card p {
                margin: 5px 0;
                font-size: 1rem;
                color: #cccccc;
            }

            .vehicle-card::before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(0, 212, 255, 0.2), transparent);
                transition: 0.5s;
            }

            .vehicle-card:hover::before {
                left: 100%;
            }

        .footer {
            margin: 20px;
            text-align: center;
            background: linear-gradient(to right, #1a1a1a, #2c2c2c);
            padding: 20px;
            border-top: 1px solid #00d4ff;
            box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.5);
            flex-shrink: 0;
        }

            .footer a {
                color: #00d4ff;
                transition: color 0.3s ease;
            }

                .footer a:hover {
                    color: #ff4d4d;
                }

        .cart-icon, .favorites-icon, .service-icon {
            color: #ffffff;
            margin-left: 10px;
            cursor: pointer;
            position: relative;
            font-size: 1.5rem;
            transition: color 0.3s ease, transform 0.3s ease;
        }

            .cart-icon:hover, .favorites-icon:hover, .service-icon:hover {
                color: #00d4ff;
                transform: scale(1.2);
            }

            .cart-icon .badge, .favorites-icon .badge, .service-icon .badge {
                background-color: #ff4d4d;
                color: white;
                font-size: 0.7em;
                padding: 3px 6px;
                border-radius: 50%;
                position: absolute;
                top: -5px;
                right: -10px;
                box-shadow: 0 0 5px rgba(255, 77, 77, 0.7);
            }

        /* Стили для модальных окон */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .modal-content {
            background: #2c2c2c;
            margin: 15% auto;
            padding: 20px;
            border-radius: 10px;
            width: 80%;
            max-width: 500px;
            color: #f1f1f1;
            border: 1px solid #00d4ff;
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.3);
        }

            .modal-content input, .modal-content select {
                width: 100%;
                padding: 8px;
                margin: 5px 0;
                background: #1a1a1a;
                border: 1px solid #00d4ff;
                border-radius: 5px;
                color: #fff;
                cursor: pointer;
            }

                .modal-content input[type="date"] {
                    color: #fff;
                    appearance: none;
                    -webkit-appearance: none;
                }

                    .modal-content input[type="date"]::-webkit-calendar-picker-indicator {
                        filter: invert(1);
                        cursor: pointer;
                    }

            .modal-content button {
                background: #00d4ff;
                border: none;
                padding: 8px 15px;
                border-radius: 5px;
                color: #fff;
                margin-right: 10px;
                transition: all 0.3s ease;
            }

                .modal-content button:hover {
                    background: #007bff;
                    transform: translateY(-2px);
                    box-shadow: 0 0 10px rgba(0, 212, 255, 0.7);
                }

        .close {
            color: #ff4d4d;
            float: right;
            font-size: 24px;
            cursor: pointer;
        }

            .close:hover {
                color: #fff;
            }

        .vehicle-card.out-of-stock {
            opacity: 0.6;
            cursor: not-allowed;
            pointer-events: none; /* Отключаем кликабельность */
        }

            .vehicle-card.out-of-stock:hover {
                transform: none; /* Отключаем анимацию при наведении */
                box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5); /* Сбрасываем тень */
            }

            .vehicle-card.out-of-stock::before {
                display: none; /* Отключаем градиент при наведении */
            }

        .text-warning {
            color: #ff4d4d;
            font-weight: bold;
            margin-top: 10px;
        }

    </style>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
</head>
<body>
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Каталог автомобілів</a>
            <div class="ms-auto d-flex align-items-center">
                <select id="sort-select" class="form-select sort-select">
                    <option value="none">Сортування</option>
                    <option value="name-asc">Назва: A → Я</option>
                    <option value="name-desc">Назва: Я → A</option>
                    <option value="price-asc">Ціна: Зростання</option>
                    <option value="price-desc">Ціна: Спадання</option>
                </select>
                <i class="fas fa-shopping-cart cart-icon" onclick="window.location.href='cart.html'"></i>
                <i class="fas fa-heart favorites-icon" onclick="window.location.href='favorites.html'"></i>
                <i class="fas fa-tools service-icon" onclick="showServiceRequestModal()"></i>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div id="admin-panel" class="admin-panel">
            <h3>Адмін-панель</h3>
            <button onclick="showAddModal()">Додати</button>
            <button onclick="showDeleteModal()">Видалити</button>
            <button onclick="showEditModal()">Редагувати</button>
        </div>

        <div class="row" id="catalog-container"></div>
    </div>

    <footer class="footer bg-dark text-center p-3">
        <p>САЛОН АВТОМОБІЛІВ</p>
        <p>Київ, Україна</p>
        <p>Phone: +380 484 7851</p>
        <p>Email: info@autosalon.ua</p>
        <div>
            <p>Корисні посилання</p>
            <a href="index.html">Головна</a> |
            <a href="#">Про нас</a> |
            <a href="#">Послуги</a> |
            <a href="#">Умови користування</a> |
            <a href="#">Політика конфіденційності</a>
        </div>
        <p>© 2024 Auto Salon. All rights reserved.</p>
    </footer>

    <!-- Модальне вікно для додавання -->
    <div id="addModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addModal')">×</span>
            <h3>Додати автомобіль</h3>
            <input type="text" id="addName" placeholder="Назва">
            <input type="number" id="addCategory" placeholder="Код категорії">
            <input type="number" id="addPrice" placeholder="Ціна">
            <input type="number" id="addYear" placeholder="Рік">
            <input type="number" id="addMileage" placeholder="Пробіг">
            <input type="text" id="addImage" placeholder="URL зображення">
            <button onclick="addVehicle()">Додати</button>
        </div>
    </div>

    <!-- Модальне вікно для видалення -->
    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('deleteModal')">×</span>
            <h3>Видалити автомобіль</h3>
            <input type="number" id="deleteCode" placeholder="Код автомобіля">
            <button onclick="deleteVehicle()">Видалити</button>
        </div>
    </div>

    <!-- Модальне вікно для редагування -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('editModal')">×</span>
            <h3>Редагувати автомобіль</h3>
            <input type="number" id="editCode" placeholder="Код автомобіля" oninput="loadVehicleData()">
            <select id="editField">
                <option value="name">Назва</option>
                <option value="category_code">Код категорії</option>
                <option value="price">Ціна</option>
                <option value="year">Рік</option>
                <option value="mileage">Пробіг</option>
                <option value="image">URL зображення</option>
            </select>
            <input type="text" id="editValue" placeholder="Нове значення">
            <button onclick="editVehicle()">Зберегти</button>
            <div id="vehicleData"></div>
        </div>
    </div>

    <!-- Модальне вікно для запису на сервіс -->
    <div id="serviceRequestModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('serviceRequestModal')">×</span>
            <h3>Запис на сервіс</h3>
            <input type="text" id="vehicleName" placeholder="Назва машини">
            <input type="number" id="vehicleYear" placeholder="Рік випуску">
            <select id="vehicleCategory" required>
                <option value="">Оберіть категорію</option>
            </select>
            <input type="date" id="serviceDate" placeholder="Дата запису" min="2025-05-20" max="2025-12-31" required>
            <select id="serviceSelect" onchange="showServiceCost()">
                <option value="">Оберіть послугу</option>
            </select>
            <p id="serviceCost" style="display: none;">Вартість: <span id="costValue">0</span> грн</p>
            <button onclick="submitServiceRequest()">Записатися</button>
        </div>
    </div>

    <script>
        $(document).ready(function () {
            const userRole = localStorage.getItem('userRole');
            if (userRole === 'admin') {
                $('#admin-panel').show();
            }

            loadVehicles();
            updateCartIcon();
            updateFavoritesIcon();

            $('#sort-select').on('change', loadVehicles);
        });

        function loadVehicles() {
            const sort = $('#sort-select').val();
            let url = 'https://localhost:7211/api/vehicles'; // Убираем параметры сортировки
            if (sort === 'name-asc') url += '?sort=name&order=asc';
            else if (sort === 'name-desc') url += '?sort=name&order=desc';
            else if (sort === 'price-asc') url += '?sort=price&order=asc';
            else if (sort === 'price-desc') url += '?sort=price&order=desc';

            $.ajax({
                url: url,
                method: 'GET',
                success: function (response) {
                    $('#catalog-container').empty();
                    let vehicles = response.data || response || [];
                    if (!Array.isArray(vehicles)) {
                        $('#catalog-container').html('<p class="text-danger">Немає даних або помилка формату.</p>');
                        return;
                    }

                    vehicles.sort((a, b) => {
                        if (sort === 'name-asc') return a.name.localeCompare(b.name, 'uk');
                        else if (sort === 'name-desc') return b.name.localeCompare(a.name, 'uk');
                        else if (sort === 'price-asc') return (a.price || 0) - (b.price || 0);
                        else if (sort === 'price-desc') return (b.price || 0) - (a.price || 0);
                        return 0;
                    });

                    function loadStockQuantity(vehicle, callback) {
                        $.ajax({
                            url: `https://localhost:7211/api/inventory/by-vehicle/${vehicle.code}`,
                            method: 'GET',
                            success: function (inventory) {
                                console.log(`Inventory response for vehicle ${vehicle.code}:`, inventory);
                                let stockQuantity = 0;
                                if (inventory && typeof inventory === 'object') {
                                    if ('Stock_Quantity' in inventory) {
                                        stockQuantity = inventory.Stock_Quantity;
                                    } else if ('stockQuantity' in inventory) {
                                        stockQuantity = inventory.stockQuantity;
                                    } else {
                                        console.warn(`No stock quantity field found for vehicle ${vehicle.code}`);
                                    }
                                } else {
                                    console.warn(`Invalid inventory response for vehicle ${vehicle.code}`);
                                }
                                callback(stockQuantity);
                            },
                            error: function (jqXHR, textStatus, errorThrown) {
                                console.error(`Error fetching inventory for vehicle ${vehicle.code}:`, textStatus, errorThrown, jqXHR.responseText);
                                callback(0);
                            }
                        });
                    }

                    let processed = 0;
                    vehicles.forEach(vehicle => {
                        const price = vehicle.price || 0;
                        loadStockQuantity(vehicle, (stockQuantity) => {
                            const vehicleCard = `
                            <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
                                <div class="vehicle-card${stockQuantity === 0 ? ' out-of-stock' : ''}" data-code="${vehicle.code}">
                                    <img src="${vehicle.image || 'placeholder.jpg'}" alt="${vehicle.name || 'Автомобіль'}">
                                    <h5>${vehicle.name || 'Невідомо'}</h5>
                                    <p>Рік: ${vehicle.year || 'Невідомо'}</p>
                                    <p>Ціна: ${typeof price === 'number' ? price.toLocaleString('uk-UA') : 'Невідомо'} грн</p>
                                    <p>На складі: ${stockQuantity} од.</p>
                                    ${stockQuantity === 0 ? '<p class="text-warning">Немає в наявності</p>' : ''}
                                </div>
                            </div>
                        `;
                            $('#catalog-container').append(vehicleCard);

                            processed++;
                            if (processed === vehicles.length) {
                                $('.vehicle-card').not('.out-of-stock').on('click', function (e) {
                                    const code = $(this).data('code');
                                    window.location.href = `details.html?code=${code}`;
                                });
                            }
                        });
                    });
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.error('Error loading vehicles:', textStatus, errorThrown, jqXHR.responseText);
                    $('#catalog-container').html('<p class="text-danger">Помилка завантаження каталогу.</p>');
                }
            });
        }

        function updateCartIcon() {
            let cart = JSON.parse(localStorage.getItem('cart') || '[]');
            let cartIcon = $('.cart-icon');
            let badge = cartIcon.find('.badge');
            if (badge.length === 0) {
                cartIcon.append('<span class="badge"></span>');
                badge = cartIcon.find('.badge');
            }
            if (cart.length > 0) {
                badge.text(cart.length).show();
            } else {
                badge.hide();
            }
        }

        function updateFavoritesIcon() {
            let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            let favoritesIcon = $('.favorites-icon');
            let badge = favoritesIcon.find('.badge');
            if (badge.length === 0) {
                favoritesIcon.append('<span class="badge"></span>');
                badge = favoritesIcon.find('.badge');
            }
            if (favorites.length > 0) {
                badge.text(favorites.length).show();
            } else {
                badge.hide();
            }
        }

        // Показати/закрити модальні вікна
        function showModal(modalId) {
            $(`#${modalId}`).css('display', 'block');
        }

        function closeModal(modalId) {
            $(`#${modalId}`).css('display', 'none');
        }

        function showAddModal() { showModal('addModal'); }
        function showDeleteModal() { showModal('deleteModal'); }
        function showEditModal() { showModal('editModal'); }
        function showServiceRequestModal() { loadServices(); loadCategories(); showModal('serviceRequestModal'); }

        function addVehicle() {
            const name = $('#addName').val();
            const categoryCode = parseInt($('#addCategory').val());
            const price = parseFloat($('#addPrice').val());
            const year = parseInt($('#addYear').val());
            const mileage = parseInt($('#addMileage').val());
            const image = $('#addImage').val();

            if (!name) {
                alert('Будь ласка, введіть назву автомобіля.');
                return;
            }
            if (isNaN(categoryCode)) {
                alert('Будь ласка, введіть коректний код категорії (число).');
                return;
            }
            if (isNaN(price) || price <= 0) {
                alert('Будь ласка, введіть коректну ціну (число більше 0).');
                return;
            }
            if (isNaN(year) || year < 1900 || year > 2025) {
                alert('Будь ласка, введіть коректний рік (1900–2025).');
                return;
            }
            if (isNaN(mileage) || mileage < 0) {
                alert('Будь ласка, введіть коректний пробіг (число >= 0).');
                return;
            }

            const vehicle = {
                name: name,
                category_code: categoryCode,
                price: price,
                year: year,
                mileage: mileage,
                image: image || null
            };

            $.ajax({
                url: 'https://localhost:7211/api/vehicles/add',
                method: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(vehicle),
                success: function () {
                    alert('Автомобіль додано!');
                    closeModal('addModal');
                    loadVehicles();
                },
                error: function (jqXHR) {
                    console.log('Error adding vehicle:', jqXHR.status, jqXHR.statusText, jqXHR.responseText);
                    alert('Помилка додавання автомобіля: ' + (jqXHR.responseJSON?.message || 'Невідома помилка'));
                }
            });
        }

        function deleteVehicle() {
            const code = $('#deleteCode').val();
            $.ajax({
                url: `https://localhost:7211/api/vehicles/${code}/hide`,
                method: 'POST',
                success: function () {
                    alert('Автомобіль прихований!');
                    closeModal('deleteModal');
                    loadVehicles();
                },
                error: function () {
                    alert('Помилка видалення автомобіля.');
                }
            });
        }

        function loadVehicleData() {
            const code = $('#editCode').val();
            if (code) {
                $.ajax({
                    url: `https://localhost:7211/api/vehicles/${code}`,
                    method: 'GET',
                    success: function (vehicle) {
                        $('#vehicleData').html(`
                                <p>Назва: ${vehicle.name}</p>
                                <p>Код категорії: ${vehicle.category_code}</p>
                                <p>Ціна: ${vehicle.price} грн</p>
                                <p>Рік: ${vehicle.year}</p>
                                <p>Пробіг: ${vehicle.mileage}</p>
                                <p>Зображення: ${vehicle.image}</p>
                            `);
                    },
                    error: function () {
                        $('#vehicleData').html('<p>Автомобіль не знайдено.</p>');
                    }
                });
            }
        }

        function editVehicle() {
            const code = $('#editCode').val();
            const field = $('#editField').val();
            const value = $('#editValue').val();
            if (code && field && value) {
                const data = { [field]: value };
                $.ajax({
                    url: `https://localhost:7211/api/vehicles/${code}/edit`,
                    method: 'PUT',
                    contentType: 'application/json',
                    data: JSON.stringify(data),
                    success: function () {
                        alert('Автомобіль оновлено!');
                        closeModal('editModal');
                        loadVehicles();
                    },
                    error: function () {
                        alert('Помилка редагування автомобіля.');
                    }
                });
            }
        }

        // Завантаження списку категорій
        function loadCategories() {
            $.ajax({
                url: 'https://localhost:7211/api/categories',
                method: 'GET',
                success: function (response) {
                    const categorySelect = $('#vehicleCategory');
                    categorySelect.empty();
                    categorySelect.append('<option value="">Оберіть категорію</option>');
                    let categories = response.data || response || [];
                    console.log('Categories response:', categories);
                    if (!Array.isArray(categories)) {
                        console.error('Categories response is not an array:', categories);
                        categorySelect.append('<option value="">Помилка завантаження категорій</option>');
                        return;
                    }
                    categories.forEach(category => {
                        // Используем PascalCase для полей
                        categorySelect.append(`<option value="${category.Code}">${category.Name}</option>`);
                    });
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.error('Error loading categories:', textStatus, errorThrown, jqXHR.responseText);
                    $('#vehicleCategory').append('<option value="">Помилка завантаження категорій</option>');
                }
            });
        }

        // Завантаження списку послуг для випадаючого списку
        let servicesData = [];
        function loadServices() {
            $.ajax({
                url: 'https://localhost:7211/api/maintenance',
                method: 'GET',
                success: function (response) {
                    const serviceSelect = $('#serviceSelect');
                    serviceSelect.empty();
                    serviceSelect.append('<option value="">Оберіть послугу</option>');
                    servicesData = response.data || response || [];
                    console.log('Maintenance response:', servicesData);
                    if (!Array.isArray(servicesData)) {
                        console.error('Maintenance response is not an array:', servicesData);
                        serviceSelect.append('<option value="">Помилка завантаження послуг</option>');
                        return;
                    }
                    servicesData.forEach(service => {
                        // Используем PascalCase для полей
                        serviceSelect.append(`<option value="${service.Code}">${service.Description}</option>`);
                    });
                },
                error: function (jqXHR, textStatus, errorThrown) {
                    console.error('Error loading maintenance:', textStatus, errorThrown, jqXHR.responseText);
                    $('#serviceSelect').append('<option value="">Помилка завантаження послуг</option>');
                }
            });
        }

        // Показ вартості послуги після вибору
        function showServiceCost() {
            const selectedServiceId = $('#serviceSelect').val();
            const costDisplay = $('#serviceCost');
            const costValue = $('#costValue');

            if (selectedServiceId) {
                const selectedService = servicesData.find(service => service.Code == selectedServiceId);
                if (selectedService) {
                    costValue.text(selectedService.Cost.toLocaleString('uk-UA'));
                    costDisplay.show();
                } else {
                    costDisplay.hide();
                }
            } else {
                costDisplay.hide();
            }
        }

        // Надсилання запиту на сервіс
        function submitServiceRequest() {
            const vehicleName = $('#vehicleName').val();
            const vehicleYear = parseInt($('#vehicleYear').val());
            const vehicleCategory = $('#vehicleCategory').val();
            const serviceDate = $('#serviceDate').val();
            const selectedServiceId = $('#serviceSelect').val();

            if (!vehicleName) {
                alert('Будь ласка, введіть назву машини.');
                return;
            }
            if (isNaN(vehicleYear) || vehicleYear < 1900 || vehicleYear > 2025) {
                alert('Будь ласка, введіть коректний рік (1900–2025).');
                return;
            }
            if (!vehicleCategory) {
                alert('Будь ласка, оберіть категорію автомобіля.');
                return;
            }
            if (!serviceDate) {
                alert('Будь ласка, оберіть дату запису.');
                return;
            }
            if (!selectedServiceId) {
                alert('Будь ласка, оберіть послугу.');
                return;
            }

            const selectedService = servicesData.find(service => service.Code == selectedServiceId);
            const selectedCategory = $('#vehicleCategory option:selected').text();
            alert(`Запис на сервіс успішний!\nМашина: ${vehicleName}\nКатегорія: ${selectedCategory}\nРік: ${vehicleYear}\nДата: ${serviceDate}\nПослуга: ${selectedService.Description}\nВартість: ${selectedService.Cost.toLocaleString('uk-UA')} грн`);
            closeModal('serviceRequestModal');
        }
    </script>
</body>
</html>